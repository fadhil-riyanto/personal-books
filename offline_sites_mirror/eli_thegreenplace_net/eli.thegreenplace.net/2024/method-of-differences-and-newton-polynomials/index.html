<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">

<!-- Mirrored from eli.thegreenplace.net/2024/method-of-differences-and-newton-polynomials/ by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 16 Feb 2025 23:55:33 GMT -->
<head>
    <title>Method of differences and Newton polynomials - Eli Bendersky's website</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="../../favicon.ico" rel="icon">

    <!-- Bootstrap -->
        <link rel="stylesheet" href="../../theme/css/bootstrap.min.css" type="text/css"/>
    <link href="../../theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="../../theme/css/pygments/vs.css" rel="stylesheet">
    <link rel="stylesheet" href="../../theme/css/style.css" type="text/css"/>

        <link href="../../feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Eli Bendersky's website ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="../../index.html" class="navbar-brand">
                <img src="../../images/logosmall.png" width="32" height="32"/>
Eli Bendersky's website            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="../../pages/about.html">
                        <i class="fa fa-question"></i>
                        <span class="icon-label">About</span>
                    </a>
                </li>
                <li>
                    <a href="../../pages/projects.html">
                        <i class="fa fa-github"></i>
                        <span class="icon-label">Projects</span>
                    </a>
                </li>
                <li>
                    <a href="../../archives/all.html">
                        <i class="fa fa-th-list"></i>
                        <span class="icon-label">Archives</span>
                    </a>
                </li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<div class="container">
    <div class="row">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="index.html"
                       rel="bookmark"
                       title="Permalink to Method of differences and Newton polynomials">
                        Method of differences and Newton polynomials
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="published">
        <i class="fa fa-calendar"></i>
        <time> April 16, 2024 at 05:54</time>
    </span>
<span class="label label-default">Tags</span>
    <a href="../../tag/math.html">Math</a>
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>I was reading about Babbage's <a class="reference external" href="https://en.wikipedia.org/wiki/Difference_engine">Difference engine</a> the other
day, and stumbled upon a very interesting application of the
<a class="reference external" href="https://en.wikipedia.org/wiki/Divided_differences">forward differences</a>
method.
It turns out that if we get a sequence generated by a polynomial, under certain
conditions we can find the generating polynomial from just a few elements in
the sequence.</p>
<p>For example, 0, 1, 5, 12, 22, 35, 51... is a sequence known as
<a class="reference external" href="https://en.wikipedia.org/wiki/Pentagonal_number">the pentagonal numbers</a>,
and we can use this technique to figure out that the polynomial
<object class="valign-m6" data="../../images/math/5b260a9d5bbd5288c720d246b76f459a34dc43b2.svg" style="height: 25px;" type="image/svg+xml">\frac{3n^2}{2}-\frac{n}{2}</object> generates it <a class="footnote-reference" href="#footnote-1" id="footnote-reference-1">[1]</a>.</p>
<div class="section" id="notation">
<h2>Notation</h2>
<p>Let's start with some mathematical notation. We'll call the underlying function
generating the sequence <object class="valign-m5" data="../../images/math/a53ffd447bcf898b6cc05d3a4f5cf05db89f6f08.svg" style="height: 19px;" type="image/svg+xml">f(n)</object>. In our example, <object class="valign-m5" data="../../images/math/e5a1616b377fb66cb2a07343c5d3cd1eb232f69f.svg" style="height: 19px;" type="image/svg+xml">f(0)=0</object>,
<object class="valign-m5" data="../../images/math/a259694d0b5a8eb2ab2bdaf5233a65b6564b6971.svg" style="height: 19px;" type="image/svg+xml">f(1)=1</object>, <object class="valign-m5" data="../../images/math/462967692d2cae32bb7c97fff3eba434f18fa36b.svg" style="height: 19px;" type="image/svg+xml">f(2)=5</object>, <object class="valign-m5" data="../../images/math/28e07a49a51fb9429d839ceba23f0f210b7e227f.svg" style="height: 19px;" type="image/svg+xml">f(3)=12</object> and so on.</p>
<ul class="simple">
<li>The <em>first difference</em> is the sequence <object class="valign-m5" data="../../images/math/90c44106d8d77c32cb18afdcb981a76f7560e2e0.svg" style="height: 19px;" type="image/svg+xml">\Delta f(0)=f(1)-f(0)</object>,
<object class="valign-m5" data="../../images/math/304708f95d4d8aa49001cce85a05201cf46b7613.svg" style="height: 19px;" type="image/svg+xml">\Delta f(1)=f(2)-f(1)</object>, etc.</li>
<li>The <em>second difference</em> is the sequence <object class="valign-m5" data="../../images/math/165a28def741d96ae27b295d3afe0845566e4c41.svg" style="height: 20px;" type="image/svg+xml">\Delta^2 f(0)=\Delta f(1) - \Delta f(0)</object>,
<object class="valign-m5" data="../../images/math/e54a7d96a0cdf8a5507cf4242033555f5e9f4129.svg" style="height: 20px;" type="image/svg+xml">\Delta^2 f(1)=\Delta f(2) - \Delta f(1)</object> etc.</li>
<li>In general, the k-th difference is: <object class="valign-m5" data="../../images/math/1c79f2519166202a7529b72c5aecb083b285a8df.svg" style="height: 20px;" type="image/svg+xml">\Delta ^k f(n)=\Delta ^{k-1}f(n+1) - \Delta ^{k-1}f(n)</object>.</li>
<li>As a starting condition in the induction of differences, we can say that
<object class="valign-m5" data="../../images/math/a53ffd447bcf898b6cc05d3a4f5cf05db89f6f08.svg" style="height: 19px;" type="image/svg+xml">f(n)</object> itself is the 0-th difference.</li>
</ul>
</div>
<div class="section" id="difference-table">
<h2>Difference table</h2>
<p>We can construct the <em>difference table</em> for our sequence and observe its
properties. In a difference table, the first column is <em>n</em>, which runs from 0
to whatever number of elements we have for the sequence. The second column is
the values of the sequence at these <em>n</em>. Then come the first difference, the
second difference and so on. For our sample sequence we get the table:</p>
<object class="align-center" data="../../images/math/ddf012f5699fff847f59b58ff97285c32fa72e99.svg" style="height: 148px;" type="image/svg+xml">\[\begin{matrix}
n &amp; f(n) &amp; \Delta f(n) &amp; \Delta ^2 f(n)  &amp;  \Delta ^3 f(n) \\
0 &amp; 0 &amp; 1 &amp; 3 &amp; 0 \\
1 &amp; 1 &amp; 4 &amp; 3 &amp; 0 \\
2 &amp; 5 &amp; 7 &amp; 3 &amp; 0 \\
3 &amp; 12 &amp; 10 &amp; 3 &amp; \\
4 &amp; 22 &amp; 13 &amp;  &amp;  \\
5 &amp; 35 &amp; &amp; &amp;
\end{matrix}\]</object>
<p>Notice how at some point the differences become all-zero! We'll soon see why.</p>
<p>Obviously, we can construct such a table from only the column of <object class="valign-m5" data="../../images/math/a53ffd447bcf898b6cc05d3a4f5cf05db89f6f08.svg" style="height: 19px;" type="image/svg+xml">f(n)</object> -
that's what we just did! A more interesting observation is that if we accept
that all differences (columns) are 0 from a certain point, we can also construct
this table from just the first row! For example, with <object class="valign-m5" data="../../images/math/233b23c15ba8894ccefa4845ae4b1954cc2c0ad7.svg" style="height: 19px;" type="image/svg+xml">f(0)</object> and
<object class="valign-m5" data="../../images/math/607ab76bc5cd741a68f8fa4a934735835cda03c8.svg" style="height: 19px;" type="image/svg+xml">\Delta f(0)</object> in hand, we know <object class="valign-m5" data="../../images/math/3c70ae40a98b1cf4bb34daa3ba2573e31e4bfd34.svg" style="height: 19px;" type="image/svg+xml">f(1)</object>; with <object class="valign-m5" data="../../images/math/607ab76bc5cd741a68f8fa4a934735835cda03c8.svg" style="height: 19px;" type="image/svg+xml">\Delta f(0)</object> and
<object class="valign-m5" data="../../images/math/673fc969775d75c8845c11bf81e042c20012dedf.svg" style="height: 20px;" type="image/svg+xml">\Delta^2 f(0)</object>, we know <object class="valign-m5" data="../../images/math/90bb6aa06dd392c5af19397ce81dc975b17b5bba.svg" style="height: 19px;" type="image/svg+xml">\Delta f(1)</object> etc. Try it!</p>
</div>
<div class="section" id="inferring-the-polynomial-s-degree-from-the-table">
<h2>Inferring the polynomial's degree from the table</h2>
<p><strong>Claim:</strong> if <object class="valign-m5" data="../../images/math/a53ffd447bcf898b6cc05d3a4f5cf05db89f6f08.svg" style="height: 19px;" type="image/svg+xml">f(n)</object> has degree <em>k</em>, then the <em>k</em>-th difference column
in the table is constant.</p>
<p><strong>Proof:</strong> this is a general <em>k</em>-th degree polynomial with coefficients
<object class="valign-m3" data="../../images/math/b93e6f239fad8d0444d74634490a6e0e067b8954.svg" style="height: 11px;" type="image/svg+xml">a_k</object>:</p>
<object class="align-center" data="../../images/math/49c985cb16cfb154ce40e4fbc738712a6f649723.svg" style="height: 22px;" type="image/svg+xml">\[f(n)=a_k n^k + a_{k-1} n^{k-1} + \cdots + a_1 n + a_0\]</object>
<p>By definition of the first difference, if we expand the polynomial form and
perform the subtraction per power of <em>n</em>:</p>
<object class="align-center" data="../../images/math/84a9b56982e89d627d41a311f021d7dae2c4938a.svg" style="height: 87px;" type="image/svg+xml">\[\begin{align*}
  \Delta f(n) &amp;= f(n+1)-f(n) = a_k (n+1)^{k} - a_k n^k + a_{k-1} (n+1)^{k-1} - a_{k-1} n^{k-1}+\cdots \\
              &amp;= \sum_{j=0}^{k} a_j(n+1)^j-a_j n^j
\end{align*}\]</object>
<p>Using the binomial theorem we know that:</p>
<object class="align-center" data="../../images/math/07156a3c7411c2da37b620fbb22a4b835c53fcfb.svg" style="height: 104px;" type="image/svg+xml">\[\begin{align*}
(n+1)^j &amp;= \sum_{i=0}^{j} \binom{j}{i}n^{j-i} \cdot 1^{i} \\
        &amp;= n^j + \binom{j}{1}n^{j-1}+\binom{j}{2}n^{j-2}+ \cdots
\end{align*}\]</object>
<p>Therefore:</p>
<object class="align-center" data="../../images/math/9160683e6cffa23bd374bf3005f43e65dbae8cce.svg" style="height: 43px;" type="image/svg+xml">\[(n+1)^j - n^j = \binom{j}{1}n^{j-1}+\binom{j}{2}n^{j-2}+ \cdots\]</object>
<p>Now if we look at the sum we got for <object class="valign-m5" data="../../images/math/e2aebbedea1d397bc0f3ea7fe157e95855cabc52.svg" style="height: 19px;" type="image/svg+xml">\Delta f(n)</object> again, we'll notice
that in each term, the <em>j</em>-th power of <em>n</em> gets canceled out. This means that
the highest power of <em>n</em> in <object class="valign-m5" data="../../images/math/e2aebbedea1d397bc0f3ea7fe157e95855cabc52.svg" style="height: 19px;" type="image/svg+xml">\Delta f(n)</object> is going to be <em>k-1</em>.</p>
<p>We can similarly show that in <object class="valign-m5" data="../../images/math/4587a8f8a107fe7ff03102fbe212d11dfb602119.svg" style="height: 20px;" type="image/svg+xml">\Delta^2 f(n)</object>, the highest power
of <em>n</em> is going to be <em>k-2</em>. Therefore, the <em>k</em>-th difference
<object class="valign-m5" data="../../images/math/20c595809e47fb8b48d6bc1cc331009539b6aa11.svg" style="height: 20px;" type="image/svg+xml">\Delta^k f(n)</object> will be constant <object class="valign-0" data="../../images/math/4a4e9e431da45a27bc880a8a1ca44d8b1b9bc143.svg" style="height: 12px;" type="image/svg+xml">\blacksquare</object>.</p>
<p>Two observations for extra credit:</p>
<ol class="arabic simple">
<li>Note that the claim goes one way - <em>if</em> <object class="valign-m5" data="../../images/math/a53ffd447bcf898b6cc05d3a4f5cf05db89f6f08.svg" style="height: 19px;" type="image/svg+xml">f(n)</object> is a <em>k</em>-th degree
polynomial, the <em>k</em>-th difference is constant. What we observe in the table
is the <em>k</em>-th difference is constant, so can we infer that the function is
a <em>k</em>-th degree polynomial? Not in the general case! The sequence could be
generated by some higher-degree polynomial, or by a completely different
kind of function. That said, since we assume <object class="valign-m5" data="../../images/math/a53ffd447bcf898b6cc05d3a4f5cf05db89f6f08.svg" style="height: 19px;" type="image/svg+xml">f(n)</object> is polynomial and
are seeking to find the simplest (lowest degree) one, this inference is
valid.</li>
<li>Did you notice the equivalence to derivatives of polynomials? The <em>k</em>-th
difference of a polynomial of degree <em>k</em> is constant... but the same is true
for the <em>k</em>-th derivative! This is not by chance - since we have a discrete
domain, differences play largely the same role as derivatives for continuous
functions. This isn't a rigorous proof - but think about the definition of
derivatives (the one with the limit) - what do you get when you take
<object class="valign-0" data="../../images/math/6d56447973863053dfb94416852d0392187be5b6.svg" style="height: 13px;" type="image/svg+xml">\Delta x</object> (also sometimes called <em>h</em>) and set it to 1?</li>
</ol>
</div>
<div class="section" id="finding-the-coefficients-with-the-newton-polynomial">
<h2>Finding the coefficients with the Newton polynomial</h2>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Polynomial_interpolation">Polynomial interpolation</a> can fit any N points
(with distinct <em>x</em> values) with a N-1 degree polynomial. One way of finding such
a polynomial was discovered by Isaac Newton and is called the
<a class="reference external" href="https://en.wikipedia.org/wiki/Newton_polynomial">Newton polynomial</a>.</p>
<p>Our problem of finding a polynomial that generates a given set of points can
be reduced to this interpolation problem, since we've just figured out the
degree of the generating polynomial! Looking at the difference table, we've
found when the difference becomes constant, and that gives us the polynomial's
degree <em>k</em>. So all we need is the first <em>k+1</em> points.</p>
<p>Here's how to develop the Newton polynomial from scratch; we'll start with the
first few coefficients and will then generalize for any <em>k</em>.</p>
<p>The Newton polynomial for our set of forward differences can be expressed as
follows:</p>
<object class="align-center" data="../../images/math/8986e72a8615d60d63a271921b27ac86f2e8cbd7.svg" style="height: 19px;" type="image/svg+xml">\[f(n) = b_0 + b_1 n + b_2 n (n-1) + \cdots + b_k n(n-1)(n-2)\cdots (n-k+1)\]</object>
<p>This polynomial is constructed in a clever way; notice that for any <em>p</em>, when
we calculate <object class="valign-m5" data="../../images/math/bcc84476cc6a5841b58dda8e57994f3c1f5e225e.svg" style="height: 19px;" type="image/svg+xml">f(p)</object> all the elements starting with <object class="valign-m6" data="../../images/math/5e9438c006a97c292f46c16b8f25dde4990d3280.svg" style="height: 18px;" type="image/svg+xml">b_{p+1}</object> will be
multiplied by zero and vanish. This helps us determine this polynomial's
coefficients in a gradual manner.</p>
<p>We'll start with the point <object class="valign-m5" data="../../images/math/96703e3d12513bb33306250114aadebf96461433.svg" style="height: 19px;" type="image/svg+xml">(0, f(0))</object>, substituting it into the Newton
polynomial:</p>
<object class="align-center" data="../../images/math/7b9efff8279fe3ddb8aa308a1eedfb728080d9f2.svg" style="height: 19px;" type="image/svg+xml">\[f(0) = b_0\]</object>
<p>This gives us the first coefficient <object class="valign-m3" data="../../images/math/2a38c2c0c99a2e9da009fc149ea917276bbbd847.svg" style="height: 15px;" type="image/svg+xml">b_0</object>. Next, let's look at
<object class="valign-m5" data="../../images/math/b303eb9d4aa35ebf9200e8672e6a87f1d2132c35.svg" style="height: 19px;" type="image/svg+xml">(1, f(1))</object>:</p>
<object class="align-center" data="../../images/math/788b381cf3eac4de29eac423286ce810063e80de.svg" style="height: 19px;" type="image/svg+xml">\[f(1) = b_0 + b_1 \cdot 1 = b_0 + b_1\]</object>
<p>Since we know that <object class="valign-m5" data="../../images/math/6799ba33e6a6f88f516dbec5dac8da3208c87712.svg" style="height: 19px;" type="image/svg+xml">b_0=f(0)</object>, we can infer that <object class="valign-m5" data="../../images/math/ecffab1104bbfa1700790488d1592833fd3fc123.svg" style="height: 19px;" type="image/svg+xml">b_1=f(1)-f(0)</object>.
Another way to express that is <object class="valign-m5" data="../../images/math/4772e72ac67c63e4f75cde07fd0185c2581657d0.svg" style="height: 19px;" type="image/svg+xml">b_1=\Delta f(0)</object>.</p>
<p>Continuing to <object class="valign-m5" data="../../images/math/45af72369888dfa1a11fdc7346a5cc2d32001013.svg" style="height: 19px;" type="image/svg+xml">(2, f(2))</object>:</p>
<object class="align-center" data="../../images/math/765c6057d2eacc86cc48329a5c11ba27d2899b65.svg" style="height: 72px;" type="image/svg+xml">\[\begin{align*}
 f(2) &amp;= b_0 + b_1 \cdot 2 + b_2 \cdot 2 \cdot 1 \\
      &amp;= b_0 + 2 b_1 + 2! b_2 \\
      &amp;= f(0) + 2 \Delta f(0) + 2! b_2
\end{align*}\]</object>
<p>We've substituted the values of <object class="valign-m3" data="../../images/math/2a38c2c0c99a2e9da009fc149ea917276bbbd847.svg" style="height: 15px;" type="image/svg+xml">b_0</object> and <object class="valign-m4" data="../../images/math/c7cd24d955e66b8fe5ce45ded69fd98da5c68ba8.svg" style="height: 17px;" type="image/svg+xml">b_1</object> that we've found
earlier; let's solve for <object class="valign-m3" data="../../images/math/5c438c10871f01d09b0425b8ddd878e495bf7ff8.svg" style="height: 15px;" type="image/svg+xml">b_2</object> now:</p>
<object class="align-center" data="../../images/math/e4a3173cf23501f41b1900321533ef57e4cce580.svg" style="height: 170px;" type="image/svg+xml">\[\begin{align*}
 b_2 &amp;= \frac{f(2) - f(0) - 2 \Delta f(0)}{2!} \\
     &amp;= \frac{f(2) - f(1) + f(1) - f(0) - 2 \Delta f(1)}{2!} \\
     &amp;= \frac{\Delta f(1) + \Delta f(0) - 2 \Delta f(0)}{2!} \\
     &amp;= \frac{\Delta f(1) - \Delta f(0)}{2!}
\end{align*}\]</object>
<p>The last line's numerator is - by definition - <object class="valign-m5" data="../../images/math/673fc969775d75c8845c11bf81e042c20012dedf.svg" style="height: 20px;" type="image/svg+xml">\Delta^2 f(0)</object>:</p>
<object class="align-center" data="../../images/math/d388e0413c1a96596556e8c123aed73c45dd2e8d.svg" style="height: 39px;" type="image/svg+xml">\[b_2 = \frac{\Delta^2 f(0)}{2!}\]</object>
<p>We can keep going with this (feel free to do <object class="valign-m5" data="../../images/math/1d56380c7fc945b51537de66595a5cbbbadd1d70.svg" style="height: 19px;" type="image/svg+xml">(3, f(3))</object> as an exercise),
but the emerging generalization is that:</p>
<object class="align-center" data="../../images/math/9e565e1e9470e65eb5df737dfd57248b82e6b22d.svg" style="height: 39px;" type="image/svg+xml">\[b_i = \frac{\Delta^i f(0)}{i!}\]</object>
<p>And a concise way to write Newton's polynomial for forward differences is:</p>
<object class="align-center" data="../../images/math/3136178faae047dc301b8c8e1f3f3bad4e43f1f9.svg" style="height: 53px;" type="image/svg+xml">\[f(n) = f(0) + \sum_{i=1}^{k} \frac{\Delta^i f(0)}{i!}g_i(n)\]</object>
<p>Where <object class="valign-m5" data="../../images/math/cfe177e3e161876e13bc7171b7f0314fdc73a651.svg" style="height: 19px;" type="image/svg+xml">g_i(n)</object> is:</p>
<object class="align-center" data="../../images/math/48bb7fa934e5b366190e384edb51b60b29693aaf.svg" style="height: 55px;" type="image/svg+xml">\[\prod_{j=0}^{i-1} (n-j)\]</object>
<p>Note that we only use the differences for <object class="valign-m5" data="../../images/math/233b23c15ba8894ccefa4845ae4b1954cc2c0ad7.svg" style="height: 19px;" type="image/svg+xml">f(0)</object>, meaning that we need
just the first row of the difference table! Let's try it for the pentagonal
numbers example.</p>
<p>First, we've determined that <object class="valign-m5" data="../../images/math/4587a8f8a107fe7ff03102fbe212d11dfb602119.svg" style="height: 20px;" type="image/svg+xml">\Delta^2 f(n)</object> is a constant, so the degree
of the polynomial is 2. We only need to calculate until <em>i=2</em> in the sum:</p>
<object class="align-center" data="../../images/math/79edb417f3a560fdb280f2c76f68aa0d32093210.svg" style="height: 39px;" type="image/svg+xml">\[f(n)=f(0)+\frac{\Delta f(0)}{1!} n + \frac{\Delta^2 f(0)}{2!} n(n-1)\]</object>
<p>Substituting the values from the difference table we have for <em>n=0</em>, we get:</p>
<object class="align-center" data="../../images/math/25a6b43d36edb1d8a473a661e93eff0e74ce5370.svg" style="height: 127px;" type="image/svg+xml">\[\begin{align*}
 f(n)&amp;=0+n+\frac{3}{2}n(n-1) \\
     &amp;=n + \frac{3n^2-3n}{2} \\
     &amp;=\frac{3 n^2}{2} -\frac{n}{2}
\end{align*}\]</object>
<p>Which is exactly what we expected!</p>
</div>
<div class="section" id="another-example">
<h2>Another example</h2>
<p>Let's work through another example, taking the sequence -8, -12, -6, 16, 60...
We'll start by constructing the difference table:</p>
<object class="align-center" data="../../images/math/c2924d0eb862dbb9fd08ff306c53d4429266ff78.svg" style="height: 126px;" type="image/svg+xml">\[\begin{matrix}
n &amp; f(n) &amp; \Delta f(n) &amp; \Delta ^2 f(n)  &amp;  \Delta ^3 f(n) \\
0 &amp; -8 &amp; -4 &amp; 10 &amp; 6 \\
1 &amp; -12 &amp; 6 &amp; 16 &amp; 6 \\
2 &amp; -6 &amp; 22 &amp; 22 &amp; \\
3 &amp; 16 &amp; 44 &amp; &amp; \\
4 &amp; 60 &amp;  &amp;  &amp;  \\
\end{matrix}\]</object>
<p>The difference <object class="valign-m5" data="../../images/math/a59fa130d9d0319438e151bf14b2f6536d5db631.svg" style="height: 20px;" type="image/svg+xml">\Delta^3 f(n)</object> appears to be constant, so we can generate
this sequence with a degree 3 polynomial. Let's use the first line of the table
to construct the Newton polynomial for it.</p>
<object class="align-center" data="../../images/math/39486c9596bdb41b9d4fbf24ab3c66674f187fd9.svg" style="height: 135px;" type="image/svg+xml">\[\begin{align*}
 f(n)&amp;=f(0)+\frac{\Delta f(0)}{1!} n + \frac{\Delta^2 f(0)}{2!} n(n-1) + \frac{\Delta^3 f(0)}{3!} n(n-1)(n-2)\\
     &amp;= -8 + \frac{-4}{1}n + \frac{10}{2}n(n-1) + \frac{6}{6}n(n-1)(n-2) \\
     &amp;= -8-4n+5n^2-5n+n^3-3n^2+2n \\
     &amp;= n^3+2n^2-7n-8
\end{align*}\]</object>
<p>Verifying that this polynomial generates our sequence as its first 5 elements
is an easy exercise.</p>
<p>Note that given 5 elements, we can always find a 4th-degree polynomial fitting
it. Here we found a 3rd-degree one, though, leveraging the technique of
differences. This becomes more acute if we have more elements in the sequence -
using differences it's often possible to find significantly simpler polynomials.</p>
</div>
<div class="section" id="recap">
<h2>Recap</h2>
<p>For an integer sequence, if this sequence is generated by a polynomial we can
figure out which polynomial it is - given enough elements. We start by
constructing a difference table and noticing if a column becomes constant from
some point on. This tells us the degree of the generating polynomial. With that
in hand, we can use the Newton polynomial to discover a polynomial that
generates the sequence.</p>
</div>
<div class="section" id="resources">
<h2>Resources</h2>
<ul class="simple">
<li><a class="reference external" href="https://ztoz.blog/posts/method-differences/">This blog post</a> was the
original inspiration. The post explains how
Babbage's difference engine worked, and makes off-hand remarks like &quot;for
a 2nd degree polynomial, we only need up to the second difference to know
everything&quot;. <a class="reference external" href="https://ztoz.blog/posts/differences-applications/">This follow-up by the same author</a>
mentioned going from sequences back to polynomials.</li>
<li>The old <a class="reference external" href="https://oeis.org/EIStext.pdf">Encyclopedia of integer sequences</a>
has an intriguing section 2.5, which unfortunately presents several lemmas
with no proofs.</li>
<li><a class="reference external" href="https://brilliant.org/wiki/method-of-differences/">This wiki page from brilliant.org</a>
is the best single resource, though its proof of constructing the Newton
polynomial is lacking, IMHO.</li>
<li>Wikipedia:
<a class="reference external" href="https://en.wikipedia.org/wiki/Divided_differences">Divided differences</a>
and <a class="reference external" href="https://en.wikipedia.org/wiki/Newton_polynomial">Newton polynomial</a>
pages.</li>
<li><a class="reference external" href="https://www.youtube.com/watch?v=xd7V0OKkEEg">Newton's forward differences YouTube lecture</a>.</li>
<li>Knuth covers this <em>very briefly</em> in section 4.6.4 of Part 2 of TAOCP,
relegating the derivation of the Newton polynomial to an exercise that has
a terse solution.</li>
</ul>
</div>
<div class="section" id="appendix-another-way-to-find-the-polynomial-s-coefficients">
<h2>Appendix: Another way to find the polynomial's coefficients</h2>
<p>Here's another way to discover the coefficients of the polynomial; the following
discusses the coefficients of the highest power, but can be generalized to
other powers as well. Using Newton's polynomial is simpler, though, so this
is just an appendix for some extra practice in manipulating such polynomials.</p>
<p><strong>Claim:</strong> if <object class="valign-m5" data="../../images/math/a53ffd447bcf898b6cc05d3a4f5cf05db89f6f08.svg" style="height: 19px;" type="image/svg+xml">f(n)</object> has degree <em>k</em>, its coefficient <object class="valign-m3" data="../../images/math/b93e6f239fad8d0444d74634490a6e0e067b8954.svg" style="height: 11px;" type="image/svg+xml">a_k</object>
is equal to <object class="valign-m6" data="../../images/math/1f8e42ade75eff67a62076b8124b881e652cc799.svg" style="height: 26px;" type="image/svg+xml">\frac{\Delta^k f(n)}{k!}</object>. Since we've proven that
<object class="valign-m5" data="../../images/math/20c595809e47fb8b48d6bc1cc331009539b6aa11.svg" style="height: 20px;" type="image/svg+xml">\Delta^k f(n)</object> is a constant, we can find the precise
value of <object class="valign-m3" data="../../images/math/b93e6f239fad8d0444d74634490a6e0e067b8954.svg" style="height: 11px;" type="image/svg+xml">a_k</object> this way.</p>
<p><strong>Proof:</strong> Let's go back to the sum formulation of <object class="valign-m5" data="../../images/math/e2aebbedea1d397bc0f3ea7fe157e95855cabc52.svg" style="height: 19px;" type="image/svg+xml">\Delta f(n)</object> from
the previous proof.</p>
<object class="align-center" data="../../images/math/17a09986b22f77c6241ff30054322e6cce33da9b.svg" style="height: 56px;" type="image/svg+xml">\[\sum_{j=0}^{k} a_j(n+1)^j-a_j n^j\]</object>
<p>Expanding the binomial, we get:</p>
<object class="align-center" data="../../images/math/1f0d1ec102ab7eab83dff4cd8478847ce6ddd450.svg" style="height: 56px;" type="image/svg+xml">\[\sum_{j=0}^{k} a_j \left [ \binom{j}{1}n^{j-1}+\binom{j}{2}n^{j-2}+ \cdots \right ]\]</object>
<p>The highest power of <em>n</em> here is <em>k-1</em>; its coefficient comes only from the
first term of the binomial expansion for <em>j=k</em>, and is equal to <object class="valign-m3" data="../../images/math/e192c5d30114375941e53a39e20ffb7ea5d3c971.svg" style="height: 15px;" type="image/svg+xml">k a_k</object>.
In order not to deal with long sums, let's just focus on the highest-degree
term in <object class="valign-m5" data="../../images/math/e2aebbedea1d397bc0f3ea7fe157e95855cabc52.svg" style="height: 19px;" type="image/svg+xml">\Delta f(n)</object>:</p>
<object class="align-center" data="../../images/math/4890eedc2566f89862ec1917a6fdc4cacbc0ceab.svg" style="height: 22px;" type="image/svg+xml">\[\Delta f(n) = k a_k n^{k-1} + \gamma\]</object>
<p>Where <object class="valign-m4" data="../../images/math/67833ee2012ec1c6254b6c009dc72bf0dc48aa6d.svg" style="height: 12px;" type="image/svg+xml">\gamma</object> represents other elements with lower powers of <em>k</em>, so we
don't care about them for this discussion <a class="footnote-reference" href="#footnote-2" id="footnote-reference-2">[2]</a>. Let's move on to the next
difference:</p>
<object class="align-center" data="../../images/math/c8fed37ba44785e2230649048abdc723c1f8cb3e.svg" style="height: 178px;" type="image/svg+xml">\[\begin{align*}
\Delta^2 f(n) &amp;= \Delta f(n+1) - \Delta f(n) \\
 &amp;= k a_k (n+1)^{k-1} + \gamma_1 - k a_k n^{k-1} + \gamma_2 \\
 &amp;= k a_k \left [ n^{k-1} + \binom{k-1}{1} n^{k-2} + \cdots \right ] - k a_k n^{k-1} + \gamma \\
 &amp;= k a_k \left [ \binom{k-1}{1} n^{k-2} + \cdots \right ] + \gamma \\
 &amp;= k(k-1)a_k n^{k-2} + \gamma
\end{align*}\]</object>
<p>We've just found the coefficient of the highest power of <em>n</em> in
<object class="valign-m5" data="../../images/math/4587a8f8a107fe7ff03102fbe212d11dfb602119.svg" style="height: 20px;" type="image/svg+xml">\Delta^2 f(n)</object>.
It's clear that if we continue doing this, <object class="valign-m5" data="../../images/math/20c595809e47fb8b48d6bc1cc331009539b6aa11.svg" style="height: 20px;" type="image/svg+xml">\Delta^k f(n)</object> will be:</p>
<object class="align-center" data="../../images/math/1e260e31360f67ec73b700fd95039aea2fae707b.svg" style="height: 22px;" type="image/svg+xml">\[\Delta^k f(n)= a_k k(k-1)(k-2)\cdots 1 = a_k k!\]</object>
<p>In other words, <object class="valign-m6" data="../../images/math/750c7571c53a8b53e71d1e645f7ae98060742ecc.svg" style="height: 26px;" type="image/svg+xml">a_k = \frac{\Delta^k f(n)}{k!}</object>, meaning that we can know
the coefficient of the highest power of <em>n</em> in <object class="valign-m5" data="../../images/math/a53ffd447bcf898b6cc05d3a4f5cf05db89f6f08.svg" style="height: 19px;" type="image/svg+xml">f(n)</object> from the <em>k</em>-th
difference <object class="valign-0" data="../../images/math/4a4e9e431da45a27bc880a8a1ca44d8b1b9bc143.svg" style="height: 12px;" type="image/svg+xml">\blacksquare</object>.</p>
<hr class="docutils" />
<table class="docutils footnote" frame="void" id="footnote-1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#footnote-reference-1">[1]</a></td><td>Naturally, there's an infinitude of potential functions that generate
this sequence; it's more precise to say we're looking for the simplest
(lowest degree)
polynomial that would do this.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="footnote-2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#footnote-reference-2">[2]</a></td><td>In the following calculation, we're playing loose with the
<object class="valign-m4" data="../../images/math/67833ee2012ec1c6254b6c009dc72bf0dc48aa6d.svg" style="height: 12px;" type="image/svg+xml">\gamma</object>s to represent &quot;anything with lower powers of <em>n</em>
that we don't care about&quot;.</td></tr>
</tbody>
</table>
</div>

            </div>
            <!-- /.entry-content -->
<hr/>
<div class="dotted-links">
<p class="align-center">
For comments, please send me
<a href="mailto:eliben@gmail.com"><i class="fa fa-envelope-o"></i> an email</a>.
</p>
</div>        </article>
    </section>

    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">
            &copy; 2003-2025 Eli Bendersky
         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://code.jquery.com/jquery-2.2.4.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="../../theme/js/bootstrap.min.js"></script>

<!--
  Using goatcounter to count visitors. The count.js script is vendored in.
-->
<script data-goatcounter="https://stats.thegreenplace.net/count"
        async src="../../theme/js/count.js"></script>
</body>

<!-- Mirrored from eli.thegreenplace.net/2024/method-of-differences-and-newton-polynomials/ by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 16 Feb 2025 23:55:33 GMT -->
</html>